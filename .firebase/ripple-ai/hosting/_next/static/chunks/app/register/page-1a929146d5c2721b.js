(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[11],{1780:function(e,r,t){Promise.resolve().then(t.bind(t,3857))},6872:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return h}});var s=t(7437),a=t(2265),o=t(1396),n=t.n(o);t(5425);var i=t(4008),l=t(4033),c=t(4032),d=t(8872);class u{async getUserData(e,r){if(console.log({user_id:e}),void 0!=e)try{let t=await (0,d.Z)({url:c.T5+c.F4+"/"+e,method:"GET",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer "+r}});if(t&&t.data)return t;throw console.error("Invalid response:",t),Error("Invalid response from the server")}catch(e){throw console.error("Error fetching user data:",e),e}}constructor(){this.getUserData=this.getUserData.bind(this)}}var m=new u,h=()=>{let{state:e,dispatch:r}=(0,i.useGlobalState)(),[t,o]=(0,a.useState)(),[c,d]=(0,a.useState)(e.user);return(0,a.useEffect)(()=>{let r=0;e.user&&(r=e.user.user_id),console.log({user_id:t,num:r})},[]),(0,a.useEffect)(()=>{if(0!=t){let r=async()=>{console.log(e);let r=await m.getUserData(t,e.user.access_token);d(r.data),console.log(r.data)};r().catch(console.error)}},[t]),(0,l.useRouter)(),(0,s.jsx)("nav",{className:"bg-zinc-800 p-4 fixed w-full z-50",children:(0,s.jsxs)("div",{className:"container mx-auto flex justify-between items-center",children:[(0,s.jsxs)(n(),{href:"/",className:"text-white text-5xl font-bold",children:["RiPPLE.",(0,s.jsx)("span",{style:{color:"orange"},children:"ai"})]}),e.user?(0,s.jsx)("div",{}):(0,s.jsx)(s.Fragment,{}),(0,s.jsxs)("div",{className:"space-x-8",children:[(0,s.jsx)(n(),{href:"/stories",className:"text-white hover:text-gray-300",children:"Stories"}),(0,s.jsx)(n(),{href:"/submissions",className:"text-white hover:text-gray-300",children:"Submissions"}),(0,s.jsx)(n(),{href:"/login",className:"text-white hover:text-gray-300",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.982 18.725A7.488 7.488 0 0012 15.75a7.488 7.488 0 00-5.982 2.975m11.963 0a9 9 0 10-11.963 0m11.963 0A8.966 8.966 0 0112 21a8.966 8.966 0 01-5.982-2.275M15 9.75a3 3 0 11-6 0 3 3 0 016 0z"})})})]})]})})}},3857:function(e,r,t){"use strict";t.r(r);var s=t(7437),a=t(2265),o=t(5425),n=t(4033),i=t(4008),l=t(3771),c=t(1396),d=t.n(c),u=t(6872);r.default=function(){let{state:e,dispatch:r}=(0,i.useGlobalState)(),t=(0,n.useRouter)(),[c,m]=(0,a.useState)({password:"",passwordConf:"",email:"",username:""}),h=(e,r)=>{m({...c,[e]:r})};async function g(e){e.preventDefault();try{let e=await o.Z.register(c);if(e.data.access_token){let s=(0,l.o)(e.data.access_token,{header:!0});await r({type:"SET_USER",payload:s}),console.log("Login success"),t.push("/")}else console.log("Login failed"),r({type:"LOGOUT_USER"})}catch(e){console.error("Registration failed:",e)}}return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.default,{}),(0,s.jsx)("section",{className:"bg-black-50 dark:bg-black-900",children:(0,s.jsx)("div",{className:"flex flex-col items-center justify-center px-6 py-8 mx-auto md:h-screen lg:py-0",children:(0,s.jsx)("div",{className:"w-full bg-black rounded-lg shadow dark:border md:mt-0 sm:max-w-md xl:p-0 dark:bg-zinc-800 dark:border-zinc-800",children:(0,s.jsxs)("div",{className:"p-6 space-y-4 md:space-y-6 sm:p-8",children:[(0,s.jsx)("h1",{className:"text-xl font-bold leading-tight tracking-tight text-gray-900 md:text-2xl dark:text-white",children:"Register your account"}),(0,s.jsxs)("form",{className:"space-y-4 md:space-y-6",action:"#",onSubmit:g,children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"email",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Your email"}),(0,s.jsx)("input",{type:"email",name:"email",id:"email",className:"bg--50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-zinc-600 dark:border-zinc-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-black-500",placeholder:"name@email.com",required:!0,onChange:e=>{c.email=e.target.value,c.username=e.target.value,m(c)}})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"password",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Password"}),(0,s.jsx)("input",{type:"password",name:"password",id:"password",placeholder:"••••••••",className:"bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-zinc-600 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",onChange:e=>h("password",e.target.value),required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"confirmPassword",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Confirm password"}),(0,s.jsx)("input",{type:"password",name:"confirmPassword",id:"confirmPassword",placeholder:"••••••••",className:"bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-zinc-600 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",onChange:e=>h("passwordConf",e.target.value),required:!0})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)("div",{className:"flex items-center h-5",children:(0,s.jsx)("input",{id:"remember","aria-describedby":"remember",type:"checkbox",className:"w-4 h-4 border border-gray-300 rounded bg-gray-50 focus:ring-3 focus:ring-primary-300 dark:bg-gray-700 dark:border-gray-600 dark:focus:ring-primary-600 dark:ring-offset-gray-800",required:""})}),(0,s.jsx)("div",{className:"ml-3 text-sm",children:(0,s.jsx)("label",{htmlFor:"remember",className:"text-gray-500 dark:text-gray-300",children:"Remember me"})})]}),(0,s.jsx)(d(),{href:"#",className:"text-sm font-medium text-primary-600 hover:underline dark:text-primary-500",children:"Forgot password?"})]}),(0,s.jsx)("button",{type:"submit",className:"w-full text-white bg-orange-500 hover:bg-orange-600 focus:ring-4 focus:outline-none focus:ring-primary-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-orange-500 dark:hover:bg-primary-700 dark:focus:ring-primary-800",children:(0,s.jsx)("input",{type:"submit",value:"Register!",className:"",disabled:!c.password||!(c.password.length>=8)||c.password!==c.passwordConf||!c.email})})]})]})})})})]})}},4008:function(e,r,t){"use strict";t.r(r),t.d(r,{GlobalStateProvider:function(){return l},useGlobalState:function(){return c}});var s=t(7437),a=t(2265);let o={user:null},n=(0,a.createContext)();function i(e,r){switch(r.type){case"SET_USER":return{...e,user:r.payload};case"LOGOUT_USER":return{...e,user:null};default:return e}}function l(e){let{children:r}=e,[t,l]=(0,a.useReducer)(i,o);return(0,s.jsx)(n.Provider,{value:{state:t,dispatch:l},children:r})}function c(){return(0,a.useContext)(n)}},8872:function(e,r,t){"use strict";t.d(r,{Z:function(){return n}});var s=t(2173),a=t(4032);let o=s.Z.create({baseURL:a.T5,headers:{"Content-Type":"application/x-www-form-urlencoded"}});o.interceptors.response.use(e=>e,e=>{let r=e.config;if(401===e.response.status&&r.url===a.T5+a.Q)return window.location.href="/login/",Promise.reject(e);if("token_not_valid"===e.response.data.code&&401===e.response.status&&"Unauthorized"===e.response.statusText){let e=localStorage.getItem("user");if(e){let t=JSON.parse(atob(e.refresh.split(".")[1])),s=Math.ceil(Date.now()/1e3);if(console.log(t.exp),t.exp>s)return o.post(a.Q,{refresh:e.refresh}).then(e=>(localStorage.setItem("user",e.data),o.defaults.headers.Authorization="Bearer "+e.data.access,r.headers.Authorization="Bearer "+e.data.access,o(r))).catch(e=>{console.log(e)});console.log("Refresh token is expired",t.exp,s),window.location.href="/login/"}else console.log("Refresh token not available."),window.location.href="/login/"}return Promise.reject(e)});var n=e=>o({...e,headers:function(){let e={"Content-Type":"application/x-www-form-urlencoded"},r=JSON.parse(localStorage.getItem("user"));return r&&r.access&&(e.Authorization="Bearer "+r.access),e}()}).then(e=>(console.debug("Request Successful!",e),e)).catch(e=>(console.error("Request Failed:",e.config),e.response?(console.error("Status:",e.response.status),console.error("Data:",e.response.data),console.error("Headers:",e.response.headers)):console.error("Error Message:",e.message),Promise.reject(e.response||e.message)))},4032:function(e,r,t){"use strict";t.d(r,{F4:function(){return i},LW:function(){return a},Q:function(){return n},T5:function(){return s},bc:function(){return o}});let s="https://8000-tresphill-rippleai2-gwyip31yybf.ws-us106.gitpod.io/api/v1/",a="login/access-token",o="users/register/",n="token/refresh/",i="users"},5425:function(e,r,t){"use strict";var s=t(4032),a=t(8872);class o{async login(e,r){try{let t=await (0,a.Z)({url:s.T5+s.LW,method:"POST",data:{username:e,password:r}});if(t.data.access_token)return this.setToken(t)}catch(e){return e.response}}logout(){localStorage.removeItem("user")}async register(e){let{username:r,email:t,password:o}=e;try{return await (0,a.Z)({url:s.T5+s.bc,method:"POST",data:{username:r,password:o,email:t}})}catch(e){return e.response}}setToken(e){return localStorage.setItem("user",JSON.stringify(e.data)),e.data}async refreshToken(){try{let e=JSON.parse(localStorage.getItem("user"));if(e.refresh){let r=await (0,a.Z)({url:s.Q,method:"POST",data:{refresh:e.refresh}});return r.data}}catch(e){return e.response}}constructor(){this.login=this.login.bind(this)}}r.Z=new o},3771:function(e,r,t){"use strict";t.d(r,{o:function(){return a}});class s extends Error{}function a(e,r){let t;if("string"!=typeof e)throw new s("Invalid token specified: must be a string");r||(r={});let a=!0===r.header?0:1,o=e.split(".")[a];if("string"!=typeof o)throw new s(`Invalid token specified: missing part #${a+1}`);try{t=function(e){let r=e.replace(/-/g,"+").replace(/_/g,"/");switch(r.length%4){case 0:break;case 2:r+="==";break;case 3:r+="=";break;default:throw Error("base64 string is not of the correct length")}try{var t;return t=r,decodeURIComponent(atob(t).replace(/(.)/g,(e,r)=>{let t=r.charCodeAt(0).toString(16).toUpperCase();return t.length<2&&(t="0"+t),"%"+t}))}catch(e){return atob(r)}}(o)}catch(e){throw new s(`Invalid token specified: invalid base64 for part #${a+1} (${e.message})`)}try{return JSON.parse(t)}catch(e){throw new s(`Invalid token specified: invalid json for part #${a+1} (${e.message})`)}}s.prototype.name="InvalidTokenError"}},function(e){e.O(0,[879,971,472,744],function(){return e(e.s=1780)}),_N_E=e.O()}]);